
<div
  class="backdrop"
  [ngClass]="{ 'hide-form': !isCommentSectionOpen}"
  (click)="toggleCommentSection()"
></div>

<div class="wrapper" [ngClass]="{ 'hide-form': !isCommentSectionOpen}">
  <div
    class="comments-container"
    *ngIf="isCommentSectionOpen"
  >
    <h4 class="text-center text-underline">Comment Section</h4>

    <form
      *ngIf="isCommentSectionOpen"
      (submit)="submitComment()"
      class="mat-elevation-z2 comment-form"
    >
      <textarea
        name="comment"
        placeholder="Please drop a comment"
        autofocus
        #commentArea="ngModel"
        minlength="4"
        maxlength="300"
        [ngClass]="{ 'focus': showSubmit || commentArea.dirty }"
        (focus)="showSubmit=true"
        (focusout)="showSubmit=false"
        [(ngModel)]="comment">
      </textarea>
      <span class="char-counter">
        {{ comment.length }} / 300
      </span>
      <button
        *ngIf="showSubmit || commentArea.dirty" type="submit">
        Comment
      </button>
    </form>
    <div class="comments">
      <ng-container
        *ngIf="comments"
      >
      <div class="comment" *ngFor="let com of comments">
        <span class="audience-name">
          <span *ngIf="com.audience">
            {{ com.audience }} Says
          </span>
          <span class="audience-name" *ngIf="!com.audience">
            Anonymous Says
          </span>
        </span>
        <div class="audience-comment">
         {{ com.comment}}
        </div>
      </div>
      </ng-container>
    </div>
  </div>
  <div [@transitionInOut] class="actions-container">
    <div class="mat-elevation-z8 actions">
      <span class="icon" (click)="clap()">
        <img src="assets/clap.png" alt="Applaud">
       </span>
       <span class="icon" (click)="toggleCommentSection()">
         <i class="fa fa-comment"></i>
       </span>
    </div>
  </div>
</div>
